language: go
sudo: false
matrix:
  include:
  - go: 1.x
    env: LATEST=true
  - go: 1.7.x
  - go: 1.8.x
  - go: 1.9.x
  - go: 1.10.x
  - go: 1.11.x
  - go: tip
  allow_failures:
  - go: tip
before_install:
- go get github.com/mitchellh/gox
install:
- 
script:
- go get -t -v ./...
- diff -u <(echo -n) <(gofmt -d .)
- go vet $(go list ./... | grep -v /vendor/)
- go test -v -race ./...
- if [ "${LATEST}" = "true" ]; then gox -os="linux darwin windows" -arch="amd64" -output="confluence-space-pdf-export.."
  -ldflags "-X main.Rev=`git rev-parse --short HEAD`" -verbose ./...; fi
deploy:
  provider: releases
  api_key:
    secure: JvN9U+zMWZ/yaji1RfYd2dbuLFrpxumKrXl5HArQoHkfb43Rw0v8tri2DBGMjmHY6bWRTfIQMXE9avrbsdLo5eB0njJMEwgOq31CRD15Tx+3PwbYs3VxKx+mwXdCTIaMTJ2f//vmvu2cbVvi+DLwsSKjr11KDrkuzshXMK0CmD4rIBCxMa6gUJFx9yT47xyF2q1wPrWAN3oeLv09bNEkMuL4VOmjCOpy82zYRJl0mg/vbz2P3SNqvDJcoPzkLOgk5Rgz+svRoTEE0fOca8THwij4sj+aTQmM84J0t8O5VgV/5oLvNC4VfTCudVMG5HCbr7gXd1L5fqyKhtlrXNPJq6DOAlfYZTyG/p2CYPdJQONLJoW1831r+s/Vb+TjHV+iDN0UgTFXA7IltXF87cI2KWmv2dh8VV1ADofL9MnIwUHj3QpVlgbbpiFW6ul94T2o3uH/cIjPfl/oOmwBBBszszZHdLMIeE7j9bGqkbmiKFM0MPtn/mZUORJDpBLCMnduyIJWB0wg/BqANbeb7E91RLTh1+a5hVG8oUYJASOj+7KfEO3pQtg/kuVABvqq8XvTc7It2VpC6QZp7MOcsIRr71ZrlBHGRKwDv+cvRF6K1YUq/pE11+LG+ejOQqdTALFQ2FfBX4ezRuKlRcrjQy/0rMSWC5uiUxJv1Ej6yaBLBK0=
  file:
    - confluence-space-pdf-export.windows.amd64.exe
    - confluence-space-pdf-export.darwin.amd64
    - confluence-space-pdf-export.linux.amd64
  on:
    repo: chrisbbe/Confluence-Space-PDF-Export
