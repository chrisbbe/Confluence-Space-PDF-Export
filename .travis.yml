language: go
sudo: false
matrix:
  include:
  - go: 1.x
    env: LATEST=true
  - go: 1.11.x
  - go: tip
  allow_failures:
  - go: tip
before_install:
- go get github.com/mitchellh/gox
install:
- 
script:
- go get -t -v ./...
- diff -u <(echo -n) <(gofmt -d .)
- go vet $(go list ./... | grep -v /vendor/)
- go test -v -race ./...
- if [ "${LATEST}" = "true" ]; then gox -os="linux darwin windows" -arch="amd64" -output="confluence-space-pdf-export.."
  -ldflags "-X main.Rev=`git rev-parse --short HEAD`" -verbose ./...; fi
deploy:
  provider: releases
  api_key:
    secure: NxkJnUMZx1NL5c2tfDw99JtA8Rc356SAkkwIO69SotK+YCuzsJFnci49ix32T3qL7LrytP1ogrzQy9qJbk+9ywTg7x1FRKGGOHsrxsePJNSVyOuaDX6AziqMYYo32C84T9OPBLo0I4uOCj5VbtyhFn1uzANUGtuESAlJYWZhbQGiblUS5AAJtkZhGaqlcdIniAR2GzgCdzK5rKcg9VSoKs9/vUj7fHi7qgnUgPoSBuZFWB3lml5L6alTR61L1m6nXeOumGj+UemcK4otHPgAryjDcYid7nmGzWRCQV4hvZoYOvApDHz3coXhOr4r+bgiUVi+qkSvhdBA1lL5OAYlEkk5giVYIvCWQBJT5tSslqBdqn4mxaoWj4+AfsBVmWMR/Pzb2phizUIWsyiDePeEXiO8sIgI95Kner/vrKBlIFEfGojIH2D2xjrD4KO56LWlFHg3rjaEcxH0RDfGu876hAtRefD2sHyegbELSpEOB9bEj6TgtTjWFwXKo8bOKq4zA8f32PyghHLTsqMcLoFWJzm9k32bD9W1m+DIPK16BqPvQQ/YM6ycEoZxVhZs0RWTiAmHcNWpFRkZ+OByX9+vOwJScTGYCVjwagxHzKTYpys5pqmviH+zp6IRiLy6Astvc6S2p6nb7c+2BZ/gWnp15SK2pfd0FERwbsVqtFEtviU=
  file: confluence-space-pdf-export.windows.amd64.exe
  on:
    repo: chrisbbe/Confluence-Space-PDF-Export
